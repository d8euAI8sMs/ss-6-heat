\documentclass[12pt,a4paper]{article}
\usepackage{russ}
\usepackage[english,russian]{babel}
\usepackage{microtype}
\usepackage{csquotes}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{mathtext}
\usepackage[notrig]{physics}
\usepackage{newfloat}
\usepackage{caption}
\usepackage{indentfirst}
\usepackage{geometry}
\usepackage{hyperref}
\usepackage{mdframed}
\usepackage[inline]{enumitem}
\usepackage{graphicx}
\usepackage{subfig}
\DeclareGraphicsExtensions{.pdf,.png,.jpg,.PNG}
\graphicspath{{./img/}}
\captionsetup[figure]{justification=centering}
\renewcommand{\thesubfigure}{\asbuk{subfigure}}
\DeclareCaptionLabelSeparator{dotseparator}{. }
\captionsetup{labelsep=dotseparator}

\begin{document}

    %
    %
    %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %                           SECTION                                   %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %
    %
    %

    \section{Постановка задачи}

        Металлический сосуд цилиндрической формы имеет высоту $L$ и радиус $R$. Толщина стенок сосуда $d$. Сосуд заполнен жидкостью с теплопроводностью $\varkappa_0$. На одной из торцевых стенок сосуда смонтирован нагреватель, расположенный на оси цилиндра. Радиус нагревателя $R_h$, а высота~--- $L_h$. Мощность нагревателя~--- $P_h$. Данный сосуд находится в безвоздушном пространстве на орбите Земли.

        Необходимо смоделировать процесс нагревания жидкости в сосуде после включения нагревателя. Начальная температура жидкости равна $T_0$.

        Как изменится процесс нагревания, если на цилиндр надеть металлическое кольцо, внутренний радиус которого равен радиусу сосуда, а внешний радиус $R_c = R + \delta$. Кольцо сделано из того же материала, что и сам сосуд. Высота кольца равна $L_c$.

    %
    %
    %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %                           SECTION                                   %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %
    %
    %

    \section{Физическая модель}

        Опишем рассматриваемую систему более формально:
        %
        \begin{enumerate}[noitemsep]
            \item Цилиндрический сосуд высотой $L$ и радиуса $R$ заполнен жидкостью с теплопроводностью $\varkappa_0$.
            \item В нижней части сосуда смонтирован нагреватель~--- область радиусом $R_h < R$ и высотой $L_h < L$, в которой выделяется энергия мощностью $P_h$.
            \item Стенки сосуда имеют толщину $d$. Боковые стенки сделаны из металла теплопроводностью $\varkappa_m$.
            \item Съемное кольцо прямоугольного сечения высоты $L_c$ с внутренним и внешним радиусами $R$ и $R_c = R + \delta$ соответственно, сделанное из того же материала, что и сосуд, может надеваться на него в произвольном месте.
            \item Система находится в безвоздушном пространстве на орбите Земли (в невесомости)~--- теплообмен с окружающей средой обеспечивается механизмом излучения. Температура среды постоянна и равна $T_0$.
            \item Сосуд полностью заполнен жидкостью при температуре среды $T_0$.
            \item В некоторый момент времени $t = 0$ включается нагреватель.
        \end{enumerate}

    %
    %
    %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %                           SECTION                                   %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %
    %
    %

    \section{Математическая модель}

        %
        %
        %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %                        SUBSECTION                               %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %
        %
        %

        \subsection{Уравнение теплопроводности}

            Уравнение теплопроводности в цилиндрических координатах имеет вид:
            %
            \begin{equation}\label{eq:heat_eq}
                c_p \pdv{T(r,z,t)}{t}
                    = \varkappa \qty(
                        \pdv[2]{T(r,z,t)}{r} +
                        \frac{1}{r} \pdv{T(r,z,t)}{r} +
                        \pdv[2]{T(r,z,t)}{z}
                    ) + P_h(r,z,t) ,
            \end{equation}
            %
            где $c_p$~--- теплоемкость материала, $\varkappa$~--- его теплопроводность. В зависимости от того, где решается уравнение, $\varkappa = \varkappa_0$ или $\varkappa = \varkappa_m$. То же относится и к теплоемкости. $\eval{T(r,z,t)}_{t=0} = T_0$.

            Необходимо дополнить уравнение граничными условиями:
            %
            \begin{equation}
                \eval{\pdv{T}{r}}_{r = 0} = 0 ; \quad
                \varkappa_m \eval{\pdv{T}{n}}_{\partial\Omega}
                    = \xi \qty(
                        \eval{T(r,z,t)}_{\partial\Omega^{+}} -
                        \eval{T(r,z,t)}_{\partial\Omega^{-}}
                    ).
            \end{equation}
            %
            Здесь через $\partial\Omega$ обозначена область, граничащая с внешней средой, причем $\partial\Omega^{-}$ принадлежит среде, а $\partial\Omega^{+}$~--- сосуду; $\pdv*{n}$~--- производная по направлению нормали к границе, $\xi$~--- некоторые параметр, характеризующий теплообмен. Эти условия выражают наличие и характер потока тепла через торцевые и боковую поверхности цилиндра (кольца), а также то обстоятельство, что линия $r = 0$ не является особой для функции $T(r,z,t)$.

            На границе сред \enquote{A}-\enquote{B} также действуют граничные условия вида:
            %
            \begin{equation}\begin{aligned}
                \eval{T(r,z,t)}_{\partial\Omega^{-}_{AB}}
                    &= \eval{T(r,z,t)}_{\partial\Omega^{+}_{AB}} , \\
                \varkappa_A \eval{\pdv{T}{n}}_{\partial\Omega^{-}_{AB}}
                    &= \varkappa_B \eval{\pdv{T}{n}}_{\partial\Omega^{+}_{AB}} ,
            \end{aligned}\end{equation}
            %
            которые выражают непрерывность температуры и потока тепла при переходе через границу сред.

            Значение параметра $\xi$, входящего в граничные условия, можно оценить из обычных условий на границе двух сред. Поскольку нас не интересует конкретный вид распределения температуры во внешней среде, можно положить $\xi \approx \flatfrac{\varkappa_e}{\Delta_e}$, где $\Delta_e$~--- расстояние, на котором температура среды становится равной $T_e$.

        %
        %
        %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %                        SUBSECTION                               %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %
        %
        %

        \subsection{Выбор единиц измерения}

            Перейдем от старых переменных к новым по правилам:
            %
            \begin{equation}
                t \mapsto \frac{t}{t_0} , \quad
                r \mapsto \frac{r}{Z_0} , \quad
                z \mapsto \frac{z}{Z_0} , \quad
                T \mapsto \frac{T}{T_0} .
            \end{equation}
            %
            Выбирая $Z_0 = \lambda \sqrt{\flatfrac{\varkappa}{c_p}}$, где $\lambda$~--- параметр, показывающий, сколько диффузионных длин за единицу времени укладывается на единице длины, и записывая в новых переменных уравнение \autoref{eq:heat_eq}, получим:
            %
            \begin{equation}\label{eq:heat_eq_dimless}
                \pdv{T}{t} = \lambda^2 \qty(
                    \pdv[2]{T}{r} + \frac{1}{r} \pdv{T}{r} + \pdv[2]{T}{z}
                ) + Q(r,z,t) ,
            \end{equation}
            %
            где $Q(r,z,t) = \frac{P(r,z,t) t_0}{c_p T_0}$. $\lambda$ для жидкости можно выбрать равной единице, тогда для металла $\lambda = \sqrt{\frac{\varkappa_m c_{p0}}{\varkappa_0 c_{pm}}}$.

    %
    %
    %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %                           SECTION                                   %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %
    %
    %

    \section{Численная модель}

        %
        %
        %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %                        SUBSECTION                               %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %
        %
        %

        \subsection{Дискретная модель}

            Для решения уравнения \autoref{eq:heat_eq_dimless} перейдем к дискретной модели. Выберем временн\'{у}ю сетку узлов с постоянным шагом по времени $\tau$: $t_0 = 0 < t_1 < \dots < t_n = t_{n - 1} + \tau$. Разделим интервал $\qty[0, R]$ на $N$ отрезков $\Delta_r$, а интервал $\qty[0, L]$~--- на $M$ отрезков $\Delta_z$. Таким образом, получим прямоугольную сетку пространственный узлов $\qty(r_i, z_j)$, $i = 0, 1, \dots, N$, $j = 0, 1, \dots, M$. Величины $\Delta_r$ и $\Delta_z$ определяются размерами минимальной области, которую необходимо описать.

            Значение температуры будем вычислять в дискретных точках: $T^n_{i,j} = T(r_i, z_j, t_n)$. Пространственные производные аппроксимируем следующим образом:
            %
            \begin{equation}\begin{aligned}
                \eval{\frac{1}{r} \pdv{T}{r}}_{i,j}
                    &\approx \frac{1}{r_i} \delta_r T_{i,j}
                    = \frac{T_{i+1,j} - T_{i-1,j}}{2 r_i \Delta_r} \\
                \eval{\pdv[2]{T}{r}}_{i,j}
                    &\approx \delta^2_r T_{i,j}
                    = \frac{T_{i+1,j} + T_{i-1,j} - 2 T_{i,j}}{\Delta^2_r} \\
                \eval{\pdv{T}{z}}_{i,j}
                    &\approx \delta_z T_{i,j}
                    = \frac{T_{i,j+1} - T_{i,j-1}}{2 \Delta_z} \\
                \eval{\pdv[2]{T}{z}}_{i,j}
                    &\approx \delta^2_z T_{i,j}
                    = \frac{T_{i,j+1} + T_{i,j-1} - 2 T_{i,j}}{\Delta^2_z}
            \end{aligned}\end{equation}

            Проинтегрируем уравнение \autoref{eq:heat_eq_dimless} по времени на участке $\qty[t_{n-1}, t_n]$, заменим производные их аппроксимацией. Получим:
            %
            \begin{equation}\label{eq:heat_eq_discrete_int}
                T^n_{i,j} = T^{n-1}_{i,j} + \int\limits_{t_{n-1}}^{t_n} { \qty(
                    \lambda^2 \qty(
                        \delta^2_r T_{i,j}(t) +
                        \frac{1}{r_i} \delta_r T_{i,j}(t) +
                        \delta^2_z T_{i,j}(t)
                    ) + Q_{i,j}(t)
                ) \dd{t}}
            \end{equation}

            В зависимости от способа интегрирования \autoref{eq:heat_eq_discrete_int} можно получить явную или неявную схему решения. Опишем и используем в решении неявную как более устойчивую.

        %
        %
        %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %                        SUBSECTION                               %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %
        %
        %

        \subsection{Неявная схема переменных направлений}

            Воспользуемся формулой трапеций для вычисления \autoref{eq:heat_eq_discrete_int}:
            %
            \begin{multline}
                T^n_{i,j} = T^{n-1}_{i,j} + \frac{\lambda^2 \tau}{2} \qty(
                    \delta^2_r \qty(T^n_{i,j} + T^{n-1}_{i,j}) +
                    \frac{1}{r_i} \delta_r \qty(T^n_{i,j} + T^{n-1}_{i,j}) +
                    \delta^2_z \qty(T^n_{i,j} + T^{n-1}_{i,j})
                ) \\ + \frac{\tau}{2} \qty(Q^n_{i,j} + Q^{n-1}_{i,j}) .
            \end{multline}
            %
            Эта система алгебраических уравнений, однако, имеет пятидиагональную матрицу, потому метод сеточной прогонки для нее не подходит.

            Представим решение \autoref{eq:heat_eq_discrete_int} в два этапа, на каждом из которых будем иметь трехдиагональную матрицу. Для этого разобьем интервал $\qty[t_{n-1}, t_n]$ на две части: $\qty[t_{n-1}, t_{n-1} + \flatfrac{\tau}{2}]$ и $\qty[t_{n-1} + \flatfrac{\tau}{2}, t_n]$. На первом полушаге используем схему решения, неявную по $r$, но явную по $z$. На втором~--- неявную по $z$ и явную по $r$. Таким образом,
            %
            \begin{equation}\begin{aligned}
                T^{n*}_{i,j} &= T^{n-1}_{i,j} + \frac{\lambda^2 \tau}{4} \qty(
                    \delta^2_r \qty(T^{n*}_{i,j} + T^{n-1}_{i,j}) +
                    \frac{1}{r_i} \delta_r \qty(T^{n*}_{i,j} + T^{n-1}_{i,j}) +
                    2 \delta^2_z T^{n-1}_{i,j}
                ) \\ &+ \frac{\tau}{4} \qty(Q^{n*}_{i,j} + Q^{n-1}_{i,j}) \\
                T^{n}_{i,j} &= T^{n*}_{i,j} + \frac{\lambda^2 \tau}{4} \qty(
                    2 \delta^2_r T^{n*}_{i,j} +
                    \frac{2}{r_i} \delta_r T^{n*}_{i,j} +
                    \delta^2_z \qty(T^n_{i,j} + T^{n*}_{i,j})
                ) \\ &+ \frac{\tau}{4} \qty(Q^n_{i,j} + Q^{n*}_{i,j})
            \end{aligned}\end{equation}
            %
            Несложно показать, что имеет место
            %
            \begin{equation}\begin{aligned}
                A^*_{i,j} T^{n*}_{i-1,j} +
                B^*_{i,j} T^{n*}_{i+1,j} +
                C^*_{i,j} T^{n*}_{i,j}   = D^*_{i,j} \\
                A_{i,j} T^n_{i,j-1} +
                B_{i,j} T^n_{i,j+1} +
                C_{i,j} T^n_{i,j}   = D_{i,j} ,
            \end{aligned}\end{equation}
            %
            где коэффициенты имеют вид:
            %
            \begin{equation}\begin{aligned}
                A^*_{i,j}
                    &= - \frac{\lambda^2 \tau}{4} \qty(
                        \frac{1}{\Delta^2_r} - \frac{1}{2 r_i \Delta_r}
                    ) ; \quad
                B^*_{i,j}
                    = - \frac{\lambda^2 \tau}{4} \qty(
                        \frac{1}{\Delta^2_r} + \frac{1}{2 r_i \Delta_r}
                    ) ; \quad
                C^*_{i,j}
                    = 1 + \frac{\lambda^2 \tau}{2 \Delta^2_r} \\
                D^*_{i,j}
                    &= T^{n-1}_{i,j}
                        + \frac{\lambda^2 \tau}{4} \qty(
                            \delta^2_r T^{n-1}_{i,j} +
                            \frac{1}{r_i} \delta_r T^{n-1}_{i,j} +
                            2 \delta^2_z T^{n-1}_{i,j}
                        )
                        + \frac{\tau}{4} \qty(Q^{n*}_{i,j} + Q^{n-1}_{i,j}) \\
                A_{i,j}
                    &= - \frac{\lambda^2 \tau}{4 \Delta^2_z} ; \quad
                B_{i,j}
                    = - \frac{\lambda^2 \tau}{4 \Delta^2_z} ; \quad
                C_{i,j}
                    = 1 + \frac{\lambda^2 \tau}{2 \Delta^2_z} \\
                D_{i,j}
                    &= T^{n*}_{i,j}
                        + \frac{\lambda^2 \tau}{4} \qty(
                            2 \delta^2_r T^{n*}_{i,j} +
                            \frac{2}{r_i} \delta_r T^{n*}_{i,j} +
                            \delta^2_z T^{n*}_{i,j}
                        )
                        + \frac{\tau}{4} \qty(Q^{n}_{i,j} + Q^{n*}_{i,j})
            \end{aligned}\end{equation}
            %

    %
    %
    %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %                           SECTION                                   %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %
    %
    %

    \section{Анализ результатов}

    %
    %
    %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %                           SECTION                                   %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %
    %
    %

    \section{Выводы}

\end{document}
